# study-go-microsystem

## 方針

本プロジェクトは、公開用ではなく、Goの理解をするためのプロジェクトのため、
Go由来の命名規則やディレクトリ構造などは省いております。

また、さまざまなパターンに対応可能にするため、必要以上にDIやインターフェースでの構造を構築し、
テストがかけるという部分に重点を置いております。

## 現時点の進捗

認証側
csrf の発行・認証
ログイン jwtの発行
リフレッシュトークンによる、jwtの再発行
新規登録処理
まで完了

新規登録処理は現時点ではテスト未実装 + 責務が分離されていないので、次回そこの調整をする

## 失敗談
9/7 
gormのインサート部分のテストを実装
gormは設定で自動トランザクションを無効化しておかないと、自動でトランザクションが貼られてしまうことが判明
テストの時にトランザクション句を指定することで、テストが通るようになったけど、
そもそも `mock.ExpectExec("INSERT INTO .*users.*").` が通る前の Begin区で落ちていたので、
モックのログにクエリが出てこなかった。
モデル生成時に0001-01-01 が原因だと決めつけて処理していたことで大幅に時間を取られてしまった。
今回のような事象で詰まった際には、`fmt.Printf("🔥 result.Error = %v\n", result.Error)` このような形で、エラーを出すなりして、
確認する。（マジで時間の無駄だった、、、反省）
